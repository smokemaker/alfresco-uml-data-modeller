<?xml version="1.0" encoding="UTF-8"?>
<?eclipse version="3.4"?>
<plugin>
   <extension
         point="org.eclipse.emf.ecore.uri_mapping">
      <mapping
            source="pathmap://Alfresco_ME_PROFILES/"
            target="platform:/plugin/ru.neodoc.content.modeller.extensions/profile/">
      </mapping>
   </extension>
   <extension
         point="org.eclipse.papyrus.uml.extensionpoints.UMLProfile">
      <profile
            description="UML profile for Alfresco Modelling Extensions"
            name="alfresco-modelling-extensions"
            path="pathmap://Alfresco_ME_PROFILES/ModellingExtensions.profile.uml">
      </profile>
   </extension>
	<extension point="org.eclipse.core.expressions.propertyTesters">
  <propertyTester
        class="ru.neodoc.content.modeller.extensions.modelexplorer.testers.ModellingExtensionsProfileTester"
        id="ru.neodoc.content.modeller.extensions.profile"
        namespace="ru.neodoc.content.modeller.extensions.profile"
        properties="extensionsEnabled,isAlfresco"
        type="java.lang.Object">
  </propertyTester>
	</extension>
 <extension
       point="org.eclipse.ui.menus">
    <menuContribution
          allPopups="false"
          locationURI="popup:org.eclipse.papyrus.views.modelexplorer.modelexplorer.popup?after=ru.neodoc.content.modeller.modelexplorer.alfresco">
       <menu
             icon="icons/menu/AlfrescoModellerExtensions.gif"
             id="ru.neodoc.content.modeller.extensions.menu"
             label="Alfresco Modelling Extensions">
          <command
                commandId="ru.neodoc.content.modeller.extensions.enable.command"
                label="Enable modelling extensions"
                style="push">
             <visibleWhen
                   checkEnabled="false">
                <with
                      variable="selection">
                   <iterate>
                      <adapt
                            type="org.eclipse.emf.ecore.EObject">
                         <not>
                            <test
                                  forcePluginActivation="true"
                                  property="ru.neodoc.content.modeller.extensions.profile.extensionsEnabled">
                            </test>
                         </not>
                      </adapt>
                   </iterate>
                </with>
             </visibleWhen>
          </command>
          <command
                commandId="ru.neodoc.content.modeller.extensions.disable.command"
                label="Disable modelling extensions"
                style="push">
             <visibleWhen
                   checkEnabled="false">
                <with
                      variable="selection">
                   <iterate>
                      <adapt
                            type="org.eclipse.emf.ecore.EObject">
                         <test
                               forcePluginActivation="true"
                               property="ru.neodoc.content.modeller.extensions.profile.extensionsEnabled">
                         </test>
                      </adapt>
                   </iterate>
                </with>
             </visibleWhen>
          </command>
          <separator
                name="ru.neodoc.content.modeller.extensions.separator.start_commands">
          </separator>
       </menu>
    </menuContribution>
 </extension>
 <extension
       point="org.eclipse.ui.handlers">
    <handler
          class="ru.neodoc.content.modeller.extensions.modelexplorer.handlers.EnableModellingExtensionsHandler"
          commandId="ru.neodoc.content.modeller.extensions.enable.command">
       <activeWhen>
          <with
                variable="selection">
             <iterate
                   operator="and">
                <adapt
                      type="org.eclipse.emf.ecore.EObject">
                   <adapt
                         type="org.eclipse.uml2.uml.Model">
                      <test
                            forcePluginActivation="true"
                            property="ru.neodoc.content.modeller.extensions.profile.isAlfresco">
                      </test>
                   </adapt>
                </adapt>
             </iterate>
          </with>
       </activeWhen>
    </handler>
    <handler
          class="ru.neodoc.content.modeller.extensions.modelexplorer.handlers.EnableModellingExtensionsHandler"
          commandId="ru.neodoc.content.modeller.extensions.disable.command">
       <activeWhen>
          <with
                variable="selection">
             <iterate
                   operator="and">
                <adapt
                      type="org.eclipse.emf.ecore.EObject">
                   <adapt
                         type="org.eclipse.uml2.uml.Model">
                      <test
                            forcePluginActivation="true"
                            property="ru.neodoc.content.modeller.extensions.profile.isAlfresco">
                      </test>
                   </adapt>
                </adapt>
             </iterate>
          </with>
       </activeWhen>
    </handler>
 </extension>
 <extension
       point="ru.neodoc.content.modeller.modellerExtension">
    <modellerExtension
          component="ru.neodoc.content.modeller.extensions.root.RootModellerExtension">
       <executorExtension
             component="ru.neodoc.content.modeller.extensions.root.RootExecutorExtension"
             executorId="*">
       </executorExtension>
    </modellerExtension>
 </extension>
 <extension
       point="ru.neodoc.content.modeller.modellerExtension">
    <modellerExtension
          component="ru.neodoc.content.modeller.extensions.enum2constraint.Enum2ConstraintModellerExtension">
       <executorExtension
             component="ru.neodoc.content.modeller.extensions.enum2constraint.Enum2ConstraintModellerExtension$UML2XMLExecutorExtension"
             executorId="ru.neodoc.content.modeller.uml2xml.UML2XMLGenerationManager">
       </executorExtension>
    </modellerExtension>
 </extension>
</plugin>
